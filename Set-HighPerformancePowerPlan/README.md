# Windows高性能电源计划自动设置工具

## 脚本说明

`Set-HighPerformancePowerPlan.cmd` 是一个自动设置Windows系统电源计划为高性能的CMD批处理脚本。

## 功能特点

- **通用兼容性**：适用于所有Windows版本（Windows 7及以上）
- **标准GUID**：使用Windows标准的高性能电源计划GUID
- **自动备份**：如果设置失败，会尝试创建新的高性能计划
- **自动权限提升**：无需手动选择"以管理员身份运行"，脚本自动处理
- **中文界面**：支持中文显示，便于中文用户使用

## 使用方法

### 1. 直接运行（推荐）
直接双击脚本文件即可，脚本会自动以管理员身份运行

### 2. 命令行运行
```cmd
# 直接运行脚本，会自动提升权限：
Set-HighPerformancePowerPlan.cmd
```

### 3. 手动以管理员身份运行
如果自动提升失败，仍可右键选择"以管理员身份运行"

## 兼容性说明

### 所有Windows版本
- **标准GUID**：`8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c`
- **电源计划名称**：在中文系统中显示为"高性能"，英文系统中显示为"High performance"
- **无需版本检测**：所有Windows版本都使用相同的GUID

## 技术原理

脚本使用以下方法设置电源计划：

1. **直接设置**：使用标准的高性能电源计划GUID
2. **自动创建**：如果设置失败，复制标准计划并重命名
3. **验证结果**：显示当前活动的电源计划

## 注意事项

- **自动权限提升**：脚本会自动以管理员身份运行，无需手动操作
- **系统兼容性**：适用于Windows 7及以上版本
- **电源管理**：设置后会影响系统性能和电池续航时间
- **GUID一致性**：所有Windows版本的高性能电源计划GUID都是相同的
- **UAC提示**：首次运行时会弹出UAC确认对话框，点击"是"即可

## 故障排除

### 常见问题

1. **权限提升失败**
   - 脚本使用runas命令自动提升权限
   - 如果失败，仍可手动右键选择"以管理员身份运行"

2. **UAC对话框**
   - 首次运行时会弹出UAC确认对话框，这是正常现象
   - 点击"是"允许脚本以管理员身份运行

3. **设置失败**
   - 检查系统电源管理服务是否正常运行
   - 脚本会自动尝试创建新的高性能计划

## 相关命令

脚本使用的主要命令：

```cmd
# 列出所有电源计划
powercfg /list

# 设置活动电源计划
powercfg /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c

# 获取当前活动电源计划
powercfg /getactivescheme

# 复制电源计划
powercfg /duplicatescheme [源GUID] [新名称]
```

## 版本信息

- 脚本版本：1.0（简化权限提升版）
- 支持系统：Windows 7/8/10/11
- 语言：CMD批处理 + 中文界面
- 更新时间：2025年08月19日
- 新增功能：使用runas命令自动权限提升

## 许可证

此脚本为开源工具，可自由使用和修改。
