# 常用PowerShell脚本集合

## 项目概述
本仓库用于集中管理各类实用的PowerShell脚本，主要面向系统管理、自动化运维和Active Directory相关操作。当前包含域批量操作、远程管理、用户权限管理等功能模块。所有脚本均按功能模块组织在独立文件夹中，便于维护和扩展。

## 📋 目录导航
- [常用PowerShell脚本集合](#常用powershell脚本集合)
  - [项目概述](#项目概述)
  - [📋 目录导航](#-目录导航)
  - [仓库结构](#仓库结构)
    - [组织规范](#组织规范)
  - [现有脚本](#现有脚本)
    - [Active Directory 域管理](#active-directory-域管理)
    - [本地/远程Windows系统管理](#本地/远程windows系统管理)
    - [防止计算机息屏,进入屏保和睡眠工具](#防止计算机息屏进入屏保和睡眠工具)
  - [使用指南](#使用指南)
    - [🚀 快速开始](#-快速开始)
    - [⚠️ 注意事项](#️-注意事项)
  - [贡献指南](#贡献指南)
    - [🤝 如何贡献](#-如何贡献)
    - [📝 开发规范](#-开发规范)
    - [🎯 贡献建议](#-贡献建议)
  - [联系作者](#联系作者)
  - [许可证](#许可证)

## 仓库结构
```
常用Powershell脚本--包括域批量操作，批量远程操作等等/
├── 📁 EnterpriseDomainJoin/
│   ├── 📄 Join-DomainRemoteBatch-Parallel-Enhanced.ps1
│   └── 📄 README.md
├── 📁 Set-HighPerformancePowerPlan/
│   ├── 📄 Set-HighPerformancePowerPlan.cmd
│   └── 📄 README.md
├── 📁 将源AD域中的用户账户批量同步至目标域中/
│   ├── 📄 将源AD域中的用户账户批量同步至目标域中.ps1
│   └── 📄 README.md
├── 📁 Add-DomailnUserToLocalAdmin/
│   ├── 📄 Add-DomainUserToLocalAdmin_fixed.ps1
│   └── 📄 README.md
├── 📁 通过ADSI查询远程Windows计算机管理员组成员/
│   ├── 📄 Get-RemoteAdminMembers_ADSI.ps1
│   └── 📄 README.md
├── 📁 Prevent-ScreenSaver-Sleep-Tool/
│   ├── 📄 Prevent-ScreenSaver-Sleep-Tool.ps1
│   └── 📄 README.md
├── 📁 系统信息查询工具/
│   ├── 📄 Get-SystemInfo.ps1
│   └── 📄 README.md
├── 📁 查询本地或远程Windows计算机当前登录用户信息/
│   └── 📄 get-currentlogonuser.ps1
├── 🖼️ AI发烧友二维码.png
└── 📄 README.md
```

### 组织规范
- **独立文件夹**：每个功能脚本或脚本组拥有独立文件夹
- **文档齐全**：每个脚本文件夹包含README.md说明文档
- **环境隔离**：脚本依赖和临时文件通过.gitignore控制
- **命名规范**：文件夹和脚本名称使用英文描述性命名，清晰反映功能用途

## 现有脚本

### Active Directory 域管理
| 脚本名称 | 功能描述 | 适用场景 | 最后更新 | 详细文档 |
|----------|----------|----------|----------|----------|
| **企业域加入批量操作脚本（增强版）** | 企业级批量域加入工具，支持高性能并行处理（1-30台同时），智能预检查，分离式域加入验证，Windows Server 2012 R2兼容，断点续传，超时控制和智能重试机制 | 大规模域加入、企业系统部署、批量运维、域迁移 | 2025-09-03 | [📖 查看详情](./EnterpriseDomainJoin/README.md) |
| **将源AD域中的用户账户批量同步至目标域中** | 跨域用户批量同步工具，支持用户属性映射、重复账户检测、邮件地址处理、操作结果统计和错误日志记录 | 域迁移、用户批量导入、多域环境管理 | 2025-06-16 | [📖 查看详情](./将源AD域中的用户账户批量同步至目标域中/README.md) |

### 本地/远程Windows系统管理
| 脚本名称 | 功能描述 | 适用场景 | 最后更新 | 详细文档 |
|----------|----------|----------|----------|----------|
| **Set-HighPerformancePowerPlan** | Windows高性能电源计划自动设置工具，支持自动权限提升，使用标准GUID设置高性能电源计划，适用于所有Windows版本 | 系统性能优化、批量电源管理、自动化运维 | 2025-08-19 | [📖 查看详情](./Set-HighPerformancePowerPlan/README.md) |
| **Add-DomailnUserToLocalAdmin** | 域账户本地管理员添加工具，使用基于DCOM的WMI连接，支持网络连通性检测、远程计算机信息收集、详细错误处理和调试输出 | 远程权限管理、批量运维、桌面支持 | 2025-07-31 | [📖 查看详情](./Add-DomailnUserToLocalAdmin/README.md) |
| **通过ADSI查询远程Windows计算机管理员组成员** | 基于ADSI技术的远程管理员组查询工具，支持本地/域账户识别、连通性检查、权限验证和错误处理 | 安全审计、权限管理、系统监控、合规检查 | 2025-07-31 | [📖 查看详情](./通过ADSI查询远程Windows计算机管理员组成员/README.md) |
| **系统信息查询工具** | 功能强大的Windows系统信息查询工具，支持本地/远程查询，使用高效的基于DCOM的CIM会话，自动收集计算机名、网络配置（含DNS）、管理员组成员、用户会话等信息，支持调试模式、超时控制、自动剪切板复制和文件保存，现已转换为独立可执行文件，双击即可查询计算机信息 | IT技术支持、故障诊断、资产管理、远程运维、系统监控 | 2025-08-01 | [📖 查看详情](./系统信息查询工具/README.md) |

### 防止计算机息屏,进入屏保和睡眠工具
| 脚本名称 | 功能描述 | 适用场景 | 最后更新 | 详细文档 |
|----------|----------|----------|----------|----------|
| **Prevent-ScreenSaver-Sleep-Tool** | 防屏保和防睡眠工具，使用Windows API (SetThreadExecutionState)调用，支持多种模式（仅防息屏、仅防睡眠、防息屏和睡眠、恢复正常），支持定时恢复功能 | 演示培训、自动化测试、远程监控、长时间操作 | 2025-07-31 | [📖 查看详情](./Prevent-ScreenSaver-Sleep-Tool/README.md) |

> 💡 **提示**：点击"📖 查看详情"链接可直接跳转到对应脚本的详细说明文档，了解使用方法、参数说明、示例等信息。

## 使用指南

### 🚀 快速开始
1. **克隆仓库**
   ```bash
   git clone https://github.com/iamtornado/common_powershell_scripts.git
   ```

2. **选择所需脚本**
   - 浏览上方脚本列表，根据功能分类选择合适的脚本
   - 点击"📖 查看详情"链接了解具体使用方法

3. **运行脚本**
   - 确保PowerShell执行策略允许脚本运行
   - 按照各脚本README中的说明配置参数和权限

### ⚠️ 注意事项
- **权限要求**：大部分脚本需要管理员权限或特定域权限
- **测试环境**：建议先在测试环境中验证脚本功能
- **参数检查**：运行前仔细检查所有必需参数
- **日志记录**：脚本执行时会生成详细日志，便于问题排查

## 贡献指南

### 🤝 如何贡献
1. **Fork本仓库** - 创建您自己的副本
2. **创建功能分支** - `git checkout -b feature/新功能名称`
3. **开发脚本** - 遵循下方开发规范
4. **提交更改** - `git commit -m "描述性提交信息"`
5. **推送分支** - `git push origin feature/新功能名称`
6. **创建Pull Request** - 详细描述功能和测试情况

### 📝 开发规范
- **文件夹结构**：每个脚本功能独立文件夹，包含`.ps1`文件和`README.md`
- **命名规范**：使用英文描述性命名，清晰反映功能用途
- **文档要求**：必须包含详细的README文档，说明功能、参数、使用示例
- **错误处理**：脚本需包含完善的错误处理和日志记录机制
- **测试验证**：提交前需在多种环境下测试验证功能正常

### 🎯 贡献建议
欢迎贡献以下类型的脚本：
- 🔐 **安全管理**：权限管理、安全审计、合规检查
- 🖥️ **桌面运维**：远程桌面管理、软件部署、系统配置
- 💾 **存储管理**：磁盘管理、备份脚本、清理工具
- 📊 **监控报表**：系统监控、性能分析、报告生成
- 🔧 **系统维护**：补丁管理、服务管理、配置管理
- 🌐 **网络管理**：网络配置、连接测试、流量分析

## 联系作者
- **DreamAI官网**：[DreamAI官方网站](https://alidocs.dingtalk.com/i/nodes/Amq4vjg890AlRbA6Td9ZvlpDJ3kdP0wQ?utm_scene=team_space)
- **QQ邮箱**：1426693102@qq.com
- **微信公众号**：AI发烧友

![AI发烧友二维码](AI发烧友二维码.png)

## 许可证
[MIT](LICENSE)