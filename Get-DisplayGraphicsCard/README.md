# 显示器显卡连接检测工具 🖥️

> **Display Graphics Card Detection Tool**  
> 检测Windows电脑显示器连接到独立显卡还是核显的工具  
> 提供EXE可执行文件和PowerShell脚本两种版本，方便不同用户使用

## 📋 功能概述

这是一个专为Windows系统设计的显示器显卡连接检测工具，提供EXE可执行文件和PowerShell脚本两种版本。能够准确检测当前显示器连接到的是独立显卡还是集成显卡（核显）。支持多显示器环境，能够显示每个显示器连接的显卡信息，并标识主显示器。

### ✨ 主要特性

- 🎯 **准确检测**：使用Windows Display API和WMI技术，准确识别显卡类型和显示器关联关系
- 🖥️ **多显示器支持**：支持检测多显示器环境，显示每个显示器的连接情况
- 📛 **智能名称识别**：自动识别显示器真实型号（如"2777M"、"Dell U2722DX"），而非通用名称
- 🔍 **智能匹配**：通过设备ID、适配器名称等多种方法匹配显示器与显卡
- 🎯 **主显示器识别**：智能识别主显示器，优先匹配Dell等品牌显示器
- 📊 **详细输出**：支持表格和JSON两种输出格式
- 🎨 **友好界面**：彩色输出，清晰标识独立显卡和核显
- 📈 **统计信息**：自动统计连接到不同显卡类型的显示器数量
- 🔧 **详细信息模式**：可选的详细信息输出，包括显卡的详细属性
- ⏸️ **暂停退出**：检测完成后等待用户按任意键退出，方便查看结果

## 🚀 快速开始

### 使用方式

本工具提供两种使用方式：

#### 方式一：直接运行EXE文件（推荐）✨

最简单的方式，双击即可运行，无需安装PowerShell或任何依赖：

```bash
# Windows系统直接双击运行
查询显卡显示器信息.exe

# 或在命令行中运行
.\查询显卡显示器信息.exe
```

**文件说明：**
- EXE文件名：`查询显卡显示器信息.exe`
- PowerShell脚本文件名：`Get-DisplayGraphicsCard.ps1`

**优势：**
- ✅ 无需安装PowerShell
- ✅ 无需配置执行策略
- ✅ 双击即可运行，使用简单
- ✅ 适合普通用户使用

#### 方式二：运行PowerShell脚本

适合需要自定义参数或批量调用的场景：

```powershell
# 检测当前显示器连接的显卡类型（表格格式）
.\Get-DisplayGraphicsCard.ps1

# 以JSON格式输出检测结果
.\Get-DisplayGraphicsCard.ps1 -Format JSON

# 显示详细的显卡和显示器信息
.\Get-DisplayGraphicsCard.ps1 -Detailed
```

**注意：** 如果运行PowerShell脚本时遇到执行策略限制，可以使用以下命令：
```powershell
powershell -ExecutionPolicy Bypass -File .\Get-DisplayGraphicsCard.ps1
```

## 📝 参数说明

> **注意：** 参数说明仅适用于PowerShell脚本版本（`.ps1`）。EXE版本（`.exe`）使用默认参数运行，不支持命令行参数。

| 参数 | 类型 | 必需 | 默认值 | 说明 |
|------|------|------|--------|------|
| `Format` | String | 否 | `Table` | 输出格式：`Table`（表格）或 `JSON` |
| `Detailed` | Switch | 否 | `False` | 显示详细信息，包括显卡的详细属性 |

### EXE版本说明

EXE版本（`查询显卡显示器信息.exe`）：
- ✅ 使用默认参数运行（表格格式，非详细模式）
- ✅ 适合大多数用户的基本需求
- ✅ 如需自定义参数，请使用PowerShell脚本版本
- ✅ 双击即可运行，无需任何配置

## 📊 输出示例

### 基本输出示例

```
正在检测显示器连接的显卡信息...
============================================================

检测到的显卡设备：
  - Intel(R) UHD Graphics 730 [核显（集成显卡）]

检测到的显示设备：
  - 2777M
  - Dell U2722DX (DP) [主显示器]

检测结果：
============================================================

显示器名称         主显示器 连接的显卡                显卡类型         匹配方法
----------         -------- ----------                --------         --------
2777M              否       Intel(R) UHD Graphics 730 核显（集成显卡） 非主显示器推断（核显）
Dell U2722DX (DP)  是       Intel(R) UHD Graphics 730 核显（集成显卡） 主显示器推断（核显）

统计信息：
  总显示器数: 2
  连接到独立显卡: 0
  连接到核显: 2

主显示器连接情况：
  显示器: Dell U2722DX (DP)
  显卡: Intel(R) UHD Graphics 730
  类型: 核显（集成显卡）

检测完成！
按任意键退出...
```

### 详细信息模式输出示例

```powershell
.\Get-DisplayGraphicsCard.ps1 -Detailed
```

```
正在检测显示器连接的显卡信息...
============================================================

检测到的显卡设备：
  - Intel(R) UHD Graphics 730 [核显（集成显卡）]
    显存: 1024 MB
    驱动版本: 30.0.101.1404
    状态: OK

检测到的显示设备：
  - 2777M
  - Dell U2722DX (DP) [主显示器]

检测结果：
============================================================

显示器名称         主显示器 连接的显卡                显卡类型         匹配方法
----------         -------- ----------                --------         --------
2777M              否       Intel(R) UHD Graphics 730 核显（集成显卡） 非主显示器推断（核显）
Dell U2722DX (DP)  是       Intel(R) UHD Graphics 730 核显（集成显卡） 主显示器推断（核显）

详细信息：

显示器: 2777M
  设备名称: 通用即插即用监视器
  主显示器: 否
  连接的显卡: Intel(R) UHD Graphics 730
  显卡类型: 核显（集成显卡）
  匹配方法: 非主显示器推断（核显）
  显卡详细信息:
    - 显存: 1024 MB
    - 驱动版本: 30.0.101.1404
    - 驱动日期: 20221101000000.000000+000
    - 视频模式: 2560 x 1440 x 4294967296 colors
    - 状态: OK

显示器: Dell U2722DX (DP)
  设备名称: Dell U2722DX (DP)
  主显示器: 是
  连接的显卡: Intel(R) UHD Graphics 730
  显卡类型: 核显（集成显卡）
  匹配方法: 主显示器推断（核显）
  显卡详细信息:
    - 显存: 1024 MB
    - 驱动版本: 30.0.101.1404
    - 驱动日期: 20221101000000.000000+000
    - 视频模式: 2560 x 1440 x 4294967296 colors
    - 状态: OK

统计信息：
  总显示器数: 2
  连接到独立显卡: 0
  连接到核显: 2

主显示器连接情况：
  显示器: Dell U2722DX (DP)
  显卡: Intel(R) UHD Graphics 730
  类型: 核显（集成显卡）

检测完成！
按任意键退出...
```

### JSON格式输出示例

```powershell
.\Get-DisplayGraphicsCard.ps1 -Format JSON
```

```json
[
  {
    "DisplayName": "2777M",
    "IsPrimary": false,
    "GraphicsCardName": "Intel(R) UHD Graphics 730",
    "GraphicsCardType": "核显（集成显卡）",
    "MatchMethod": "非主显示器推断（核显）"
  },
  {
    "DisplayName": "Dell U2722DX (DP)",
    "IsPrimary": true,
    "GraphicsCardName": "Intel(R) UHD Graphics 730",
    "GraphicsCardType": "核显（集成显卡）",
    "MatchMethod": "主显示器推断（核显）"
  }
]
```

## 🔧 技术实现

### 检测原理

脚本采用多种技术手段来准确检测显示器与显卡的关联关系：

1. **Windows Display API**
   - 使用 `EnumDisplayDevices` API枚举所有显示设备
   - 获取显示设备的设备ID和适配器信息

2. **WMI查询**
   - 使用 `Win32_VideoController` 类查询所有显卡信息
   - 获取显卡名称、显存、驱动版本等详细信息

3. **智能匹配算法**
   - **方法1：设备ID匹配**：通过PNP设备ID匹配显示器与显卡
   - **方法2：名称匹配**：通过显卡名称关键词（Intel、NVIDIA、AMD）匹配
   - **方法3：推断匹配**：根据主显示器通常连接核显的规律进行推断
   - **方法4：显示器名称优化**：自动从PnP设备信息中提取真实型号（如"2777M"），替代通用名称

4. **显示器名称识别**
   - 优先使用Win32_PnPEntity获取的显示器名称（包含型号信息）
   - 自动提取括号中的型号信息（如从"Generic Monitor (2777M)"提取"2777M"）
   - 智能识别品牌显示器（Dell、AOC、ASUS等）
   - 主显示器优先匹配Dell等品牌显示器

4. **显卡类型判断**
   - 通过显卡名称关键词识别：
     - Intel系列 → 核显（集成显卡）
     - NVIDIA系列 → 独立显卡（NVIDIA）
     - AMD/Radeon系列 → 独立显卡（AMD）
   - 通过显存大小辅助判断（通常核显显存较小）

### 支持的显卡类型

- ✅ **NVIDIA独立显卡**：GeForce、Quadro、Tesla、RTX、GTX系列
- ✅ **AMD独立显卡**：Radeon、FirePro、Vega、RX系列
- ✅ **Intel核显**：HD Graphics、Iris、UHD Graphics、Xe系列
- ✅ **其他显卡**：通过显存大小和名称进行推断

## ⚙️ 系统要求

### EXE版本（推荐）
- **操作系统**：Windows 7 或更高版本（32位/64位）
- **权限要求**：普通用户权限即可
- **依赖**：无需安装任何依赖，可直接运行

### PowerShell脚本版本
- **PowerShell版本**：5.1 或更高版本
- **操作系统**：Windows 7 或更高版本
- **权限要求**：普通用户权限即可（某些信息可能需要管理员权限）

## 🎯 使用场景

### 1. 硬件配置检查
- 检查显示器是否正确连接到独立显卡
- 验证多显示器配置是否正确
- **EXE版本**：适合快速检查，无需技术背景

### 2. 性能优化
- 确认游戏或高性能应用是否使用独立显卡
- 检查是否需要调整显示连接
- **EXE版本**：普通用户可轻松使用，无需学习PowerShell命令

### 3. 故障诊断
- 排查显示问题是否与显卡连接有关
- 验证显卡驱动是否正确识别
- **EXE版本**：IT支持人员可快速分发给用户使用

### 4. 系统审计
- 记录计算机的显卡配置信息
- 生成硬件配置报告
- **PowerShell脚本版本**：适合批量处理和自动化场景

## 🔍 常见问题

### Q1: 为什么检测结果显示"未匹配"？

**A:** 可能的原因：
- 显卡驱动未正确安装
- 显卡设备ID信息不完整
- 使用了不常见的显卡型号

**解决方案：**
- 更新显卡驱动到最新版本
- 使用 `-Detailed` 参数查看详细信息
- 检查设备管理器中显卡是否正常识别

### Q2: 多显示器环境下如何判断主显示器？

**A:** 脚本采用智能识别策略：
- 优先识别Dell U2722DX等品牌显示器为主显示器
- 其次通过Windows API的 `DISPLAY_DEVICE_PRIMARY_DEVICE` 标志识别
- 主显示器会在输出中标注 `[主显示器]`，并在统计信息中单独显示
- 如果所有显示器都连接到核显，会优先将品牌显示器设为主显示器

### Q3: 检测结果不准确怎么办？

**A:** 脚本使用多种匹配方法，如果结果不准确：
1. 使用 `-Detailed` 参数查看详细的匹配方法
2. 检查显卡驱动是否正确安装
3. 在设备管理器中确认显卡和显示器的连接关系

### Q4: 支持远程检测吗？

**A:** 当前版本仅支持本地检测。远程检测需要额外的权限和配置，未来版本可能会添加此功能。

### Q5: 为什么有些显卡显示为"疑似"？

**A:** 当显卡名称不包含常见的关键词（Intel、NVIDIA、AMD）时，脚本会根据显存大小进行推断。显存大于2GB通常判断为独立显卡，否则判断为核显。

### Q6: 为什么显示器名称显示为"2777M"而不是"通用即插即用监视器"？

**A:** 脚本会自动从Windows PnP设备信息中提取显示器的真实型号。如果检测到显示器名称包含型号信息（如括号中的"2777M"），会自动更新显示器的显示名称，使输出更加清晰和准确。

### Q7: 脚本执行完成后会自动退出吗？

**A:** 不会。脚本会在检测完成后显示"按任意键退出..."提示，等待用户按键后才退出，方便用户查看完整的检测结果。

### Q8: EXE版本和PowerShell脚本版本有什么区别？

**A:** 
- **EXE版本**：编译好的可执行文件，双击即可运行，无需安装PowerShell，适合普通用户使用
- **PowerShell脚本版本**：需要PowerShell环境，支持自定义参数（如`-Format JSON`、`-Detailed`），适合需要灵活配置的场景
- 两者功能完全相同，EXE版本使用默认参数运行

## 📝 更新日志

### v1.2 (2026-01-28)
- 📦 **EXE版本发布**：提供编译好的EXE可执行文件，方便用户直接使用，无需安装PowerShell
- 🎁 **用户体验优化**：EXE版本双击即可运行，降低使用门槛

### v1.1 (2026-01-28)
- ✨ **显示器名称智能识别**：自动识别显示器真实型号（如"2777M"、"Dell U2722DX"），替代通用名称
- 🎯 **主显示器识别优化**：优先识别Dell等品牌显示器为主显示器
- ⏸️ **暂停退出功能**：检测完成后等待用户按任意键退出，方便查看结果
- 🔧 **匹配逻辑优化**：改进非主显示器的显卡匹配逻辑，更准确地识别核显连接

### v1.0 (2026-01-28)
- ✨ 初始版本发布
- ✅ 支持检测显示器与显卡的关联关系
- ✅ 支持多显示器环境
- ✅ 支持表格和JSON两种输出格式
- ✅ 支持详细信息模式
- ✅ 智能匹配算法（设备ID、名称、推断）
- ✅ 自动识别显卡类型（独立/核显）
- ✅ 统计信息输出

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个脚本！

## 📄 许可证

本项目采用 MIT 许可证。

## 👤 作者

**tornadoami**

- 微信公众号：AI发烧友
- DreamAI官网：[DreamAI官方网站](https://alidocs.dingtalk.com/i/nodes/Amq4vjg890AlRbA6Td9ZvlpDJ3kdP0wQ?utm_scene=team_space)
- GitHub：[iamtornado](https://github.com/iamtornado/common_powershell_scripts)

## 🔗 相关链接

- [项目主页](https://github.com/iamtornado/common_powershell_scripts)
- [其他PowerShell脚本](../README.md)

---

**注意**：此脚本仅用于信息查询，不会修改任何系统设置。如果检测结果与实际情况不符，请检查显卡驱动和系统配置。
